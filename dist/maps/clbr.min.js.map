{"version":3,"sources":["clbr.js"],"names":["window","$","console","error","clbr","authApi","url","signup","email","password","fn","data","post","done","result","fail","jqXHR","textStatus","err","signin","setRedirect","redirect_url","callbackUri","ajax","type","xhrFields","withCredentials","facebook","location","href","twitter","google","vk","refresh","refreshToken","headers","Authorization","signout","signoutall","merge","access_token1","access_token2","unmerge","access_token","provider","id","get","del","jQuery","profilesApi","public","update","name","projectsApi","listMy","listPublic","top","last_id","save","angular","module","factory","urls","constant","login","logout","directive","restrict","require","link","scope","elem","attrs","control","checker","e1","$eval","ngModel","e2","cbConfirm","$watch","value","$setValidity","exception","message","alert","config","$stateProvider","state","templateUrl","controller","pageTitle","$scope","$state","events","user","replace","menuExpanded","expandMenu","$on","event","$digest","go","signoff","destroy","profile","loading","submit","params","accessToken","init","goFacebook","goTwitter","goGoogle","goVk","$rootScope","$interval","$location","$window","$cookies","emitLoginEvent","$broadcast","emitLogoutEvent","persisitTokens","now","Date","exp","getFullYear","getMonth","getDate","putObject","cookieKey","expires","restoreTokens","getObject","refreshTokens","getTokensFromSocialRedirect","search","refresh_token","setRedirectUrl","baseUri","protocol","host","port","memberships","i","length","intervalId","cancel","extend","fields","undefined","tokens","app","$urlRouterProvider","$locationProvider","$mdThemingProvider","abstract","template","otherwise","theme","primaryPalette","accentPalette","default","hue-1","hue-2","hue-3","toState","isDefined"],"mappings":"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","file":"clbr.min.js","sourcesContent":["(function(window, $) {\n  \n  if (!$) {\n    return console.error('jQuery required.');\n  }\n\n  var clbr = window.clbr = window.clbr || {};\n\n  clbr.authApi = function (url) {\n    return {\n      // Sign up by email and password\n      signup: function (email, password, fn) {\n        var data = {\n          email: email,\n          password: password\n        };\n\n        $.post(url + '/signup', data)\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Sign in by email and password\n      signin: function (email, password, fn) {\n        var data = {\n          email: email,\n          password: password\n        };\n\n        $.post(url + '/signin', data)\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Sets redirect url after social registrations\n      setRedirect: function (redirect_url, fn) {\n        var data = {\n          callbackUri: redirect_url\n        };\n\n        $.ajax({\n            url: url + '/social',\n            type: 'POST',\n            data: data,\n            xhrFields: {\n              withCredentials: true\n           }\n          })\n          .done(function() {\n            fn();\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Registration/login via Facebook\n      facebook: function () {\n        window.location.href = url + '/facebook';\n      },\n\n      // Registration/login via Twitter\n      twitter: function () {\n        window.location.href = url + '/twitter';\n      },\n\n      // Registration/login via Google\n      google: function () {\n        window.location.href = url + '/google';\n      },\n\n      // Registration/login via Vk\n      vk: function () {\n        window.location.href = url + '/vk';\n      },\n\n      // Updates access & refresh tokens\n      refresh: function (refreshToken, fn) {\n        $.ajax({\n            url: url + '/refresh',\n            type: 'GET',\n            headers: {'Authorization': 'JWT ' + refreshToken}\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Signs out current user\n      signout: function (refreshToken, fn) {\n        $.ajax({\n            url: url + '/signout',\n            type: 'DELETE',\n            headers: {'Authorization': 'JWT ' + refreshToken}\n          })\n          .done(function() {\n            fn();\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Deletes all sessions for current user\n      signoutall: function (refreshToken, fn) {\n        $.ajax({\n            url: url + '/signoutall',\n            type: 'DELETE',\n            headers: {'Authorization': 'JWT ' + refreshToken}\n          })\n          .done(function() {\n            fn();\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Merges two accaunts\n      merge: function (access_token1, access_token2, fn) {\n        var data = {\n          token1: access_token1,\n          token2: access_token2\n        };\n\n        $.ajax({\n            url: url + '/merge',\n            type: 'POST'\n          })\n          .done(function() {\n            fn();\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Unmerges social account\n      unmerge: function (access_token, provider, id, fn) {\n        var data = {\n          provider: provider,\n          id: id\n        };\n\n        $.ajax({\n            url: url + '/unmerge',\n            type: 'DELETE',\n            headers: {'Authorization': 'JWT ' + access_token}\n          })\n          .done(function() {\n            fn();\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Gets user info\n      get: function (access_token, fn) {\n        $.ajax({\n            url: url + '/account',\n            type: 'GET',\n            headers: {'Authorization': 'JWT ' + access_token}\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Deletes user account\n      del: function (access_token, fn) {\n        $.ajax({\n            url: url + '/account',\n            type: 'DELETE',\n            headers: {'Authorization': 'JWT ' + access_token}\n          })\n          .done(function() {\n            fn();\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      }\n    };\n  };\n\n})(window, window.jQuery);\n(function(window, $) {\n  \n  if (!$) {\n    return console.error('jQuery required.');\n  }\n\n  var clbr = window.clbr = window.clbr || {};\n\n  clbr.profilesApi = function (url) {\n    return {\n      // Get full profile info\n      get: function (id, access_token, fn) {\n        $.ajax({\n            url: url + '/' + id,\n            type: 'GET',\n            headers: {'Authorization': 'JWT ' + access_token}\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Get public profile info\n      public: function (id, access_token, fn) {\n        $.ajax({\n            url: url + '/public/' + id,\n            type: 'GET',\n            headers: {'Authorization': 'JWT ' + access_token}\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Update profile info\n      update: function (id, email, name, access_token, fn) {\n        var data = {\n          email: email,\n          name: name\n        };\n\n        $.ajax({\n            url: url + '/' + id,\n            type: 'PUT',\n            headers: {'Authorization': 'JWT ' + access_token},\n            data: data\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      }\n    };\n  };\n\n})(window, window.jQuery);\n(function(window, $) {\n  \n  if (!$) {\n    return console.error('jQuery required.');\n  }\n\n  var clbr = window.clbr = window.clbr || {};\n\n  clbr.projectsApi = function (url) {\n    return {\n      // Get project info\n      get: function (id, access_token, fn) {\n        if (!fn) {\n          fn = access_token;\n          access_token = null;\n        }\n\n        var headers = {};\n        if (access_token) {\n          headers['Authorization'] = 'JWT ' + access_token;\n        }\n        \n        $.ajax({\n            url: url + '/' + id,\n            type: 'GET',\n            headers: headers\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // List all projects for current user\n      listMy: function (access_token, fn) {\n        $.ajax({\n            url: url,\n            type: 'GET',\n            headers: {'Authorization': 'JWT ' + access_token}\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // List all public projects\n      listPublic: function (top, last_id, fn) {\n        if (!fn) {\n          fn = last_id;\n          last_id = null;\n        }\n\n        last_id = last_id || '';\n\n        $.ajax({\n            url: url + '/all?' + 'top=' + top + '&last=' + last_id,\n            type: 'GET'\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Creates new project\n      save: function (data, access_token, fn) {\n        $.ajax({\n            url: url + '/' + id,\n            type: 'POST',\n            headers: {'Authorization': 'JWT ' + access_token},\n            data: data\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      },\n\n      // Update profile info\n      update: function (id, data, access_token, fn) {\n        $.ajax({\n            url: url + '/' + id,\n            type: 'PUT',\n            headers: {'Authorization': 'JWT ' + access_token},\n            data: data\n          })\n          .done(function(result) {\n            fn(null, result);\n          })\n          .fail(function(jqXHR, textStatus, err) {\n            fn(err);\n          });\n      }\n    };\n  };\n\n})(window, window.jQuery);\n(function(window, angular, clbr) {\n  \"use strict\";\n\n  var module = angular.module('auth-api', ['settings']);\n\n  module.factory('authApi', [\n    'urls', function (urls) {\n      return clbr.authApi(urls.authApi);\n    }\n  ]);  \n    \n})(window, window.angular, window.clbr);\n(function(window, angular) {\n    \"use strict\";\n\n    angular.module('constants', []) \n      .constant('events', {\n      \t'login': 'login',\n        'logout': 'logout'\n      });\n    \n})(window, window.angular);\n(function(window, angular) {\n    \"use strict\";\n    \n    var module = angular.module('directives', ['menu']);\n\n    // input confirmation (e.g. passwords match)\n    module.directive('cbConfirm', function() {\n        return {\n          restrict: 'A',\n          require: 'ngModel',\n          link: function(scope, elem, attrs, control) {\n            var checker = function() {\n              var e1 = scope.$eval(attrs.ngModel);\n              var e2 = scope.$eval(attrs.cbConfirm);\n              return e1 == e2 || (!e1 && !e2);\n            };\n            scope.$watch(checker, function(value) {\n              // set the form control to valid if both \n              // inputs are the same, else invalid\n              control.$setValidity(\"match\", value);\n            });\n          }\n        };\n    });\n    \n})(window, window.angular);\n(function(window, angular) {\n    \"use strict\";\n\n    var module = angular.module('exceptions', []);\n\n    module.factory('$exceptionHandler', [\n      function () {\n        return function (exception) {\n          var message = exception.message;\n          if (!message || message === '[object Object]') {\n              message = 'Application Error';\n          }\n\n          alert(message);\n        };\n      }\n    ]);\n    \n})(window, window.angular);\n(function(window, angular) {\n    \"use strict\";\n\n    var module = angular.module('home', [\n      'ui.router'\n    ]);\n\n    // Routes\n    module.config([\n      '$stateProvider', function ($stateProvider) {\n        $stateProvider\n          .state('home', {\n            url: '/',\n            templateUrl: 'home.html',\n            controller: 'HomeCtrl',\n            data: {\n              pageTitle: 'Clickberry Video Portal'\n            }\n          });\n        }\n    ]);\n\n    // Controllers\n    module.controller('HomeCtrl', [\n      '$scope', '$state',\n      function ($scope, $state) {\n\n        \n        \n      }\n    ]);\n    \n})(window, window.angular);\n(function (window, angular) {\n    \"use strict\";\n\n    var module = angular.module('menu', ['user', 'constants']);\n\n    module.directive('cbMenu', [\n        '$state', 'events', 'user', function ($state, events, user) {\n          return {\n            restrict: 'EA',\n            replace: true,\n            templateUrl: 'menu.html',\n            link: function($scope) {\n              $scope.menuExpanded = false;\n              $scope.expandMenu = function() {\n                $scope.menuExpanded = !$scope.menuExpanded;\n              };\n\n              $scope.user = null;\n              $scope.$on(events.login, function (event, data) {\n                $scope.user = data;\n                $scope.$digest();\n              });\n              $scope.$on(events.logout, function () {\n                $scope.user = null;\n                $state.go('home');\n              });\n\n              $scope.signoff = function () {\n                user.destroy();\n              };\n\n              $scope.signup = function () {\n                $state.go('signup');\n              };\n\n              $scope.signin = function () {\n                $state.go('signin');\n              };\n\n              $scope.profile = function () {\n                $state.go('profile');\n              };\n            }\n          };\n        }\n    ])\n\n})(window, window.angular);\n(function (window, angular) {\n    \"use strict\";\n\n    var module = angular.module('profile', [\n      'ui.router',\n      'profiles-api',\n      'user'\n    ]);\n\n    // Routes\n    module.config([\n      '$stateProvider', function ($stateProvider) {\n        $stateProvider\n          .state('profile', {\n            url: '/profile',\n            templateUrl: 'profile.html',\n            controller: 'ProfileCtrl',\n            data: {\n              pageTitle: 'Your Profile on Clickberry'\n            }\n          });\n        }\n    ]);\n\n    // Controllers\n    module.controller('ProfileCtrl', [\n      '$scope', '$state', 'profilesApi', 'user',\n      function ($scope, $state, profilesApi, user) {\n\n        $scope.profile = {};\n        $scope.loading = false;\n\n        $scope.submit = function (params) {\n          $scope.loading = true;\n          profilesApi.update(user.id, params.email, params.name, user.accessToken, function (err) {\n            if (err) { throw err; }\n            $scope.loading = false;\n            $scope.$digest();\n          });\n        };\n\n        (function load() {\n          $scope.loading = true;\n          profilesApi.get(user.id, user.accessToken, function (err, data) {\n            if (err) { throw err; }\n            $scope.profile = data;\n            $scope.loading = false;\n            $scope.$digest();\n          });\n        })();\n      }\n    ]);\n})(window, window.angular);\n(function(window, angular, clbr) {\n  \"use strict\";\n\n  var module = angular.module('profiles-api', ['settings']);\n\n  module.factory('profilesApi', [\n    'urls', function (urls) {\n      return clbr.profilesApi(urls.profilesApi);\n    }\n  ]);  \n    \n})(window, window.angular, window.clbr);\n(function(window, angular, clbr) {\n  \"use strict\";\n\n  var module = angular.module('projects-api', ['settings']);\n\n  module.factory('projectsApi', [\n    'urls', function (urls) {\n      return clbr.projectsApi(urls.projectsApi);\n    }\n  ]);\n    \n})(window, window.angular, window.clbr);\n(function(window, angular) {\n    \"use strict\";\n\n    angular.module('settings', []) \n      .constant('urls', {\n        'authApi': 'http://auth.qa.clbr.ws',\n        'profilesApi': 'http://profiles.qa.clbr.ws',\n        'projectsApi': 'http://projects.qa.clbr.ws'\n      });\n    \n})(window, window.angular);\n(function (window, angular) {\n    \"use strict\";\n\n    var module = angular.module('signin', [\n      'ui.router',\n      'auth-api',\n      'user'\n    ]);\n\n    // Routes\n    module.config([\n      '$stateProvider', function ($stateProvider) {\n        $stateProvider\n          .state('signin', {\n            url: '/signin',\n            templateUrl: 'signin.html',\n            controller: 'SigninCtrl',\n            data: {\n              pageTitle: 'Sign in to Clickberry'\n            }\n          });\n        }\n    ]);\n\n    // Controllers\n    module.controller('SigninCtrl', [\n      '$scope', '$state', 'authApi', 'user',\n      function ($scope, $state, authApi, user) {\n\n        $scope.signin = {};\n        $scope.loading = false;\n\n        $scope.submit = function (params) {\n          $scope.loading = true;\n          authApi.signin(params.email, params.password, function (err, data) {\n            if (err) { throw err; }\n            user.init(data.accessToken, data.refreshToken);\n            $scope.loading = false;\n            \n            $state.go('home');\n          });\n        };\n\n        $scope.goFacebook = function () {\n          $scope.loading = true;\n          authApi.facebook();\n        };\n\n        $scope.goTwitter = function () {\n          $scope.loading = true;\n          authApi.twitter();\n        };\n\n        $scope.goGoogle = function () {\n          $scope.loading = true;\n          authApi.google();\n        };\n\n        $scope.goVk = function () {\n          $scope.loading = true;\n          authApi.vk();\n        };\n      }\n    ]);\n})(window, window.angular);\n(function (window, angular) {\n    \"use strict\";\n\n    var module = angular.module('signup', [\n      'ui.router',\n      'auth-api'\n    ]);\n\n    // Routes\n    module.config([\n      '$stateProvider', function ($stateProvider) {\n        $stateProvider\n          .state('signup', {\n            url: '/signup',\n            templateUrl: 'signup.html',\n            controller: 'SignupCtrl',\n            data: {\n              pageTitle: 'Sign up on Clickberry'\n            }\n          });\n        }\n    ]);\n\n    // Controllers\n    module.controller('SignupCtrl', [\n      '$scope', '$state', 'authApi',\n      function ($scope, $state, authApi) {\n\n        $scope.signup = {};\n        $scope.loading = false;\n\n        $scope.submit = function (params) {\n          $scope.loading = true;\n          authApi.signup(params.email, params.password, function (err, data) {\n            if (err) { return alert('Error: ' + err.message); }\n            $scope.loading = false;\n\n            $state.go('home');\n          });\n        };\n\n        $scope.goFacebook = function () {\n          $scope.loading = true;\n          authApi.facebook();\n        };\n\n        $scope.goTwitter = function () {\n          $scope.loading = true;\n          authApi.twitter();\n        };\n\n        $scope.goGoogle = function () {\n          $scope.loading = true;\n          authApi.google();\n        };\n\n        $scope.goVk = function () {\n          $scope.loading = true;\n          authApi.vk();\n        };\n      }\n    ]);\n})(window, window.angular);\n(function (window, angular) {\n    \"use strict\";\n\n    var module = angular.module('user', ['auth-api', 'constants', 'ngCookies']);\n\n    module.factory('user', [\n      '$rootScope', '$interval', '$location', '$window', '$cookies', 'authApi', 'events',\n        function ($rootScope, $interval, $location, $window, $cookies, authApi, events) {          \n          var cookieKey = 'tokens';\n          var intervalId;\n          var user = {};\n\n          var fields = {\n            id: undefined,\n            email: undefined,\n            accessToken: undefined,\n            refreshToken: undefined\n          };\n\n          // emits login event\n          function emitLoginEvent(data) {\n            $rootScope.$broadcast(events.login, data);\n          }\n\n          // emits logout event\n          function emitLogoutEvent() {\n            $rootScope.$broadcast(events.logout);\n          }\n\n          // persists tokens for 1 month\n          function persisitTokens() {\n            if (!user.accessToken || !user.refreshToken) {\n              return;\n            }\n\n            var now = new $window.Date();\n            // this will set the expiration to 1 month\n            var exp = new $window.Date(now.getFullYear(), now.getMonth() + 1, now.getDate());\n\n            var value = {accessToken: user.accessToken, refreshToken: user.refreshToken};\n            $cookies.putObject(cookieKey, value, { expires: exp });\n          }\n\n          // restores tokens\n          function restoreTokens() {\n            return $cookies.getObject(cookieKey);\n          }\n\n          // refreshes tokens\n          function refreshTokens() {\n            authApi.refresh(user.refreshToken, function (err, data) {\n                if (err) { throw err; }\n                user.accessToken = data.accessToken;\n                user.refreshToken = data.refreshToken;\n              });\n          }\n\n          // handles social login redirects\n          function getTokensFromSocialRedirect() {\n            var params = $location.search();\n            if (params.access_token && params.refresh_token){\n              return {\n                accessToken: user.access_token, \n                refreshToken: user.refresh_token\n              };\n            }\n          }\n\n          // set social callback\n          function setRedirectUrl() {\n            var baseUri = $location.protocol() + '://' + $location.host() + ':' + $location.port() + '/#/'; // /#/ to use angular routing\n            authApi.setRedirect(baseUri, function () {});\n          }\n\n          // inits a user account\n          function init (accessToken, refreshToken) {\n            user.accessToken = accessToken;\n            user.refreshToken = refreshToken;\n\n            // gets user account info\n            authApi.get(accessToken, function (err, data) {\n              if (err) { throw err; }\n              user.id = data.id;\n              user.email = data.email;\n              if (!user.email && data.memberships) {\n                // checking memberships\n                var i;\n                for (i = 0; i < data.memberships.length; ++i) {\n                  if (data.memberships[i].email) {\n                    user.email = data.memberships[i].email;\n                    break;\n                  }\n                }\n              }\n\n              emitLoginEvent({id: user.id, email: user.email});\n              persisitTokens();\n            });\n\n            // sets the interval to refresh token\n            intervalId = $interval(function() {\n              refreshTokens();\n            }, 60000);\n          }\n\n          // destroys the account\n          function destroy () {\n            $interval.cancel(intervalId);\n            angular.extend(user, fields);\n            emitLogoutEvent();\n          }\n\n          // module init\n          (function moduleInit() {\n            setRedirectUrl();\n\n            // get tokens from redirect url\n            var tokens = getTokensFromSocialRedirect();\n            if (tokens) {\n              return init(tokens.accessToken, tokens.refreshToken);\n            }\n            \n            // get tokens from cookies\n            tokens = restoreTokens();\n            if (tokens) {\n              return init(tokens.accessToken, tokens.refreshToken);\n            }\n          })();\n\n          user.init = init;\n          user.destroy = destroy;\n\n          return user;\n        }\n  ]);\n\n})(window, window.angular);\n(function (window, angular) {\n    'use strict';\n\n    var app = angular.module('clbr', [\n      'ui.router', // for ui routing\n      'ngMaterial', // activate material design\n      'home',\n      'signup',\n      'signin',\n      'profile',\n      'directives',\n      'user',\n      'exceptions'\n    ]);\n\n    // Config\n    app.config([\n      '$urlRouterProvider', '$locationProvider', '$stateProvider', '$mdThemingProvider',\n      function ($urlRouterProvider, $locationProvider, $stateProvider, $mdThemingProvider) {\n        \n        // routes\n        $stateProvider\n          .state('clbr', {\n            'abstract': true,\n            template: '<div ui-view></div>'\n          });\n\n        // html5 routing without #\n        $urlRouterProvider.otherwise('/');\n        // $locationProvider.html5Mode(true);\n\n        // theme\n        $mdThemingProvider.theme('default')\n          .primaryPalette('grey')\n          .accentPalette('green', {\n            'default': '500',\n            'hue-1': '200',\n            'hue-2': '700',\n            'hue-3': 'A200'\n          });\n      }\n    ]);\n\n    // Main application controller\n    app.controller('ClickberryCtrl', [\n      '$rootScope',\n      function ($rootScope) {\n\n        $rootScope.pageTitle = 'Clickberry Video Portal';\n        $rootScope.$on('$stateChangeSuccess', function (event, toState/*, toParams, from, fromParams*/) {\n          if (angular.isDefined(toState.data) && angular.isDefined(toState.data.pageTitle)) {\n            $rootScope.pageTitle = toState.data.pageTitle;\n          }\n        });\n      }\n    ]);\n\n})(window, window.angular);"],"sourceRoot":"/source/"}